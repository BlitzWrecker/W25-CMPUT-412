---
title: "Exercise 1 - Duckiebot Assembly and Basic Development"
collection: reports
permalink: /report/exercise-1
excerpt: 'Written report for lab exercise 1'
date: 2025-01-16
---

{% include base_path %}

<h1>Demos</h1>

<h2>Straight Line Demo</h2>
<iframe src="https://youtube.com/embed/AvUAT5J6rS4?si=4vfmCBxzyagFSciH" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<p>
  The video above shows the Duckiebot driving straight in a 2-meter straight line. This video was recorded after calibrating the wheels.
  Even after calibration, we can still see the Duckiebot deviating from the straight line. This can be due to multiple reasons:
</p>
<ul>
  <li>The Duckiebot's wheels are not perfectly aligned.</li>
  <li>The rubber tire on the wheels are deformed.</li>
  <li>The mat is uneven.</li>
  <li>etc</li>
</ul>

<h2>Lane Following Demo</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/5pTgiVmlDpU?si=q78yc7wk1YFfdcwB" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<p>
  The video above shows the Duckiebot driving straight in a 2-meter straight line. This video was recorded after calibrating both the wheels and the camera.
  The Duckiebot sometimes follows the lane, and sometimes it follows the center line. The Duckiebot deviates from the lane and also makes adjustments when it encounters a turn in the track.
  The TAs explained some potential causes:
</p>
<ul>
  <li>Network delays. </li>
  <li>The lane indicators (the white and yellow tapes) start bending on turns. </li>
  <li>The carpet may also affect how the Duckiebot "interpret" the lane. </li>
</ul>

<br>
<h1>Duckiebot Operations</h1>

<h2>Dashboard</h2>
<img src="{{ base_path }}/images/dashboard.png" alt="Image of the Duckietown dashboard">
<p>
  The Mission Control tab on the dashboard displays the camera output and motor signals. This screenshot is taken when the Duckiebot is stationary.
</p>

<h2>Camera Intrinsic Calibration</h2>
<img src="{{ base_path }}/images/camera_intrinsics.png" alt="Camera intrinsic calibration file">
<p>
  The camera intrinsic calibration file. Intrinsic calibration parameters are used to map the 3D world to the 2D image.
</p>

<h2>Camera Extrinsic Calibration</h2>
<img src="{{ base_path }}/images/camera_extrinsics.png" alt="Camera extrinsic calibration file">
<p>
  The camera extrinsic calibration file. Extrinsic calibration parameters are used to determine the position of the camera in the world.
</p>

<h2>Kinematics Calibration</h2>
<img src="{{ base_path }}/images/kinematics.png" alt="Kinematics calibration file">
<p>
  The kinematics calibration file. Kinematics calibration accounts for the varying degrees of defects in the Duckiebot's motors and wheels.
</p>


<h2>Duckiebot Greeting</h2>
<img src="{{ base_path }}/images/hello_world.png" alt="Duckiebot running a hello world program from a Docker image">
<p>
  The Duckiebot running a hello world program from a Docker image.
</p>

<h1>Write Up</h1>
<h2>Hello World</h2>
<p>
  In this lab exercise, I implemented a <a href="https://github.com/BlitzWrecker/W25-CMPUT-412/blob/master/Exercise_1/packages/hello_world/hello_world.py">Hello World program</a>. When executed on a Duckiebot, the program simply prints "Hello from &lt;ROBOT_NAME&gt;!"
  I also learned how to build a Docker image that runs the Hello World program on my Duckiebot. By using Docker, I can build images for arbitrary programs and run them on the Duckiebots without having to know about the details of the Duckiebots', say, OS, firmware, hardware interfaces, etc.
</p>

<h2>Calibration</h2>
<p>
  I faced a lot of challenges when calibrating my Duckiebot's camera and wheels.
</p>

<h3>Camera</h3>
<p>
  Camera calibration is very important because it determines the value of the parameters that maps the 3D world to the 2D video frames captured by the camera. We did two types of camera calibrations: intrinsic calibration and extrinsic calibration.
  When calibrating the camera, we used a GUI tools that displays what the Duckiebot's camera is capturing. The data was transmitted over Wi-Fi, and network delays makes the calibration process very inefficient and frustrating.
  During intrinsic calibration especially, we often had to wait quite some time after moving the calibration board for the GUI application to update the camera output of the Duckiebot.
</p>

<h3>Wheels</h3>
<p>
  Different level of wears on the motor, deformed rubber tires, and numerous other factors can cause the Duckiebot to not drive in a straight line.
  Therefore, wheel/motor calibration is also important because it accounts for all these factors by setting the trim.
</p>

<h2>Lane following demo</h2>
<p>
  During the lane following demo, my Duckiebot had a lot of trouble following the lane during turns.
  I speculate that Duckiebot is using the lane indicators (the white and yellow tapes) to follow the lanes during the demo.
  At the turns, the lane indicators bends. Because of the field of view of the camera, the camera may fail to capture this change.
  Additionally, the irregular reflection of the carpet may also interfere with how the Duckiebot "interpret" the lane.
</p>
<p>
  When following the straight portion of the lane, the Duckiebot occasionally deviates from the lane a little but continues driving in a straight line. This might be because the mat is uneven.
  I think that the Duckiebot can use a gyroscope to detect this drift (if the Duckiebot is equipped with one). Or, the Duckiebot can use the lane indicators to detect this drift.
  The Duckiebot can then adjust its motors appropriately to adjust for this drift.
</p>
<p>
  If image processing and motor decisions are done on our laptop and then send back to the Duckiebot (as we were sending signals from our laptop to the Duckiebot to start and stop lane follow), then network delays will also affect how the Duckiebot drives.
</p>

<h2>Conclusion</h2>
<p>
  All in all, this lab was fun. Although calibrating the hardware can mitigate some of the negative effects that inherent hardware defects may bring to the operations of the Duckiebots, calibration will not help deal with the factors in the environment that are external to the Duckiebots.
  Despite the occasional frustrations, I have learned to be patient with the Duckiebots.
</p>

<h1>References</h1>
<ul>
  <li>
    <a href="https://docs-old.duckietown.org/daffy/duckietown-robotics-development/out/python_programs_environments.html" target="_blank">
      https://docs-old.duckietown.org/daffy/duckietown-robotics-development/out/python_programs_environments.html
    </a>
  </li>
  <li>
    <a href="https://docs.duckietown.com/daffy/opmanual-duckiebot/setup/setup_laptop/setup_dependencies.html" target="_blank">
      https://docs.duckietown.com/daffy/opmanual-duckiebot/setup/setup_laptop/setup_dependencies.html
    </a>
  </li>
</ul>
